# non-machine version
xvcv_mdlc_pc_machine_auto_district_city = {
	base_buildtime = @xvcv_mdlc_district_time_3
	icon = xvcv_mdlc_pc_mechanical_district_city
	is_capped_by_modifier = no
	exempt_from_ai_planet_specialization = yes
	default_starting_district = yes

	zone_slots = {
		slot_city_government
		slot_city_01
		slot_city_02
	}

	show_on_uncolonized = {
		exists = from
		from = {
			oxr_mdlc_planet_owner_can_build_wm_districts = yes
			has_auth_machine_intelligence = no
		}
		uses_district_set = xvcv_mdlc_pc_machine_auto_district_set
	}
	potential = {
		exists = owner
		owner = {
			oxr_mdlc_planet_owner_can_build_wm_districts = yes
			has_auth_machine_intelligence = no
		}
		uses_district_set = xvcv_mdlc_pc_machine_auto_district_set
	}

	conversion_ratio = 1
	convert_to = {
		xvcv_mdlc_pc_machine_auto_district_origin_primary
		xvcv_mdlc_pc_machine_auto_district_nexus
		district_crashed_slaver_ship
		district_arcology_housing
		district_rw_city
		district_nexus
		district_hive
		district_prison
		district_craglands
		district_mindlink
		district_crashed_slaver_ship
		district_resort
		district_slave
	}


	resources = {
		category = planet_districts_cities
		cost = {
			minerals = @xvcv_mdlc_district_cost_3
		}
		upkeep = { energy = 2 }
	}

	planet_modifier = {
		planet_housing_add = 1000
		planet_amenities_add = 1200
	}

	# Copy triggered modifiers from "district_city"
	inline_script = planet/districts/vanilla/oxr_city_filler

	on_built = {
		if = {
			limit = { 
				owner = { has_origin = oxr_mdlc_origin_world_machine_awakened }
			}
			owner = {
				fire_on_action = { on_action = on_world_machine_district_completed_country }
			}
			planet = {
				fire_on_action = { on_action = on_world_machine_district_completed_planet }
			}
		}
	}
	on_destroy = {
		planet = {
			fire_on_action = { on_action = on_world_machine_district_demolished }
		}
		
	}
}
# machine intelligence version
xvcv_mdlc_pc_machine_auto_district_nexus = {
	base_buildtime = @xvcv_mdlc_district_time_3
	icon = xvcv_mdlc_pc_mechanical_district_nexus
	is_capped_by_modifier = no
	exempt_from_ai_planet_specialization = yes
	default_starting_district = yes

	zone_slots = {
		slot_city_government
		slot_city_01
		slot_city_02
	}

	show_on_uncolonized = {
		exists = from
		from = {
			has_xvcv_mdlc_ap_world_machines = yes
			has_authority = auth_machine_intelligence
		}
		uses_district_set = xvcv_mdlc_pc_machine_auto_district_set
	}
	potential = {
		exists = owner
		owner = {
			has_xvcv_mdlc_ap_world_machines = yes
			has_authority = auth_machine_intelligence
		}
		uses_district_set = xvcv_mdlc_pc_machine_auto_district_set
	}

	conversion_ratio = 1
	convert_to = {
		xvcv_mdlc_pc_machine_auto_district_city
		xvcv_mdlc_pc_machine_auto_district_origin_primary
		district_arcology_housing
		district_rw_nexus
		district_city
		district_hive
		district_craglands
		district_mindlink
	}

	resources = {
		category = planet_districts_cities
		cost = {
			minerals = @xvcv_mdlc_district_cost_3
		}
		upkeep = { energy = 2 }
	}

	planet_modifier = {
		planet_housing_add = 1100
		planet_amenities_no_happiness_add = 1200
	}

	inline_script = planet/districts/vanilla/oxr_nexus_filler

	on_built = {
		if = {
			limit = { 
				owner = { has_origin = oxr_mdlc_origin_world_machine_awakened }
			}
			owner = {
				fire_on_action = { on_action = on_world_machine_district_completed_country }
			}
			planet = {
				fire_on_action = { on_action = on_world_machine_district_completed_planet }
			}

		}
	}
	on_destroy = {
		if = {
			limit = { 
				owner = { has_origin = oxr_mdlc_origin_world_machine_awakened }
			}
			planet = {
				fire_on_action = { on_action = on_world_machine_district_demolished }
			}
		}
	}
}

xvcv_mdlc_pc_machine_auto_district_generator = {
	base_buildtime = @xvcv_mdlc_district_time_2
	icon = xvcv_mdlc_pc_mechanical_district_generator
	is_capped_by_modifier = no

	zone_slots = {
		oxr_mdlc_origin_wm_slot_energy
	}

	show_on_uncolonized = {
		exists = from
		from = { oxr_mdlc_planet_owner_can_build_wm_districts = yes }
		uses_district_set = xvcv_mdlc_pc_machine_auto_district_set
	}
	potential = {
		exists = owner
		owner = { oxr_mdlc_planet_owner_can_build_wm_districts = yes }
		uses_district_set = xvcv_mdlc_pc_machine_auto_district_set
	}

	conversion_ratio = 1
	convert_to = {
		xvcv_mdlc_pc_machine_auto_district_generator_origin_wm
		district_generator_uncapped
		district_photosynthesis_fields
		district_photosynthesis_fields_uncapped
		district_nexus_1
		district_hive_1
	}

	# produces
	resources = {
		inline_script = {
			script = planet/districts/auto/oxr_mdlc_generator
			JOBS = 2
		}
		produces = {
			trigger = { has_active_building = rikk_mdlc_world_machine_SR_building }
			volatile_motes = 0.20
			mult = value:scripted_modifier_mult|MODIFIER|rikk_mdlc_world_machine_districts_base_production|
		}
		upkeep = {
			trigger = { has_active_building = rikk_mdlc_world_machine_SR_building }
			minerals = 2
		}
	}
	triggered_desc = {
		trigger = {
			has_active_building = rikk_mdlc_world_machine_SR_building
		}
		text = xvcv_mdlc_generator_district_motes_produces
	}
	inline_script = planet/buildings/auto/oxr_auto_biofuel

	ai_resource_production = {
		energy = 20
		trigger = { always = yes }
	}
	on_built = {
		if = {
			limit = { 
				owner = { has_origin = oxr_mdlc_origin_world_machine_awakened }
			}
			owner = {
				fire_on_action = { on_action = on_world_machine_district_completed_country }
			}
			planet = {
				fire_on_action = { on_action = on_world_machine_district_completed_planet }
			}
			
		}
	}
	on_destroy = {
		planet = {
			fire_on_action = { on_action = on_world_machine_district_demolished }
		}
		
	}
}

xvcv_mdlc_pc_machine_auto_district_mining = {
	base_buildtime = @xvcv_mdlc_district_time_2
	icon = xvcv_mdlc_pc_mechanical_district_mining
	is_capped_by_modifier = no

	zone_slots = {
		oxr_mdlc_origin_wm_slot_minerals
	}

	show_on_uncolonized = {
		exists = from
		from = { oxr_mdlc_planet_owner_can_build_wm_districts = yes }
		uses_district_set = xvcv_mdlc_pc_machine_auto_district_set
	}
	potential = {
		exists = owner
		owner = { oxr_mdlc_planet_owner_can_build_wm_districts = yes }
		uses_district_set = xvcv_mdlc_pc_machine_auto_district_set
	}

	conversion_ratio = 1
	convert_to = {
		xvcv_mdlc_pc_machine_auto_district_mining_origin_wm
		district_mining_uncapped
		district_hollow_mountains
		district_hollow_mountains_uncapped
		district_nexus_2
		district_hive_2
	}

	resources = {
		# category = planet_miners
		category = xvcv_mdlc_world_machines_mining_districts
		cost = {
			minerals = @xvcv_mdlc_district_cost_2
		}
		produces = {
			minerals = @[ 2 * oxr_mdlc_wm_base_miner_output ]
			mult = value:scripted_modifier_mult|MODIFIER|rikk_mdlc_world_machine_districts_base_production|
		}
		produces = { 
			trigger = {
				exists = owner
				owner = {
					has_tradition = tr_nanotech_1
				}
			}
			nanites = @[ 2 * oxr_mdlc_wm_base_drone_nanite_output ]
			mult = value:scripted_modifier_mult|MODIFIER|rikk_mdlc_world_machine_districts_base_production|
		}
		upkeep = { 
			energy = @xvcv_mdlc_pc_machine_auto_district_mining_upkeep  # 2 drones * 1, plus 1 base district upkeep 
		}
		produces = {
			trigger = {
				has_building = oxr_mdlc_world_machines_building_auto_mining_support
			}
			minerals = 1
			mult = value:scripted_modifier_mult|MODIFIER|rikk_mdlc_world_machine_districts_base_production|
		}
		produces = {
			trigger = {
				has_building = oxr_mdlc_world_machines_building_auto_mining_support
			}
			minerals = 2
			mult = value:scripted_modifier_mult|MODIFIER|rikk_mdlc_world_machine_districts_base_production|
		}
		produces = {
		trigger = { has_active_building = rikk_mdlc_world_machine_SR_building }
			rare_crystals = 0.20
			mult = value:scripted_modifier_mult|MODIFIER|rikk_mdlc_world_machine_districts_base_production|
			
		}
		upkeep = {
		trigger = { has_active_building = rikk_mdlc_world_machine_SR_building }
			energy = 1
		}
	}
	triggered_desc = {
		trigger = {
			has_active_building = rikk_mdlc_world_machine_SR_building
		}
		text = xvcv_mdlc_mining_district_crystals_produces
	}

	ai_resource_production = {
		minerals = 10
		trigger = { always = yes }
	}
	on_built = {
		if = {
			limit = { 
				owner = { has_origin = oxr_mdlc_origin_world_machine_awakened }
			}
			owner = {
				fire_on_action = { on_action = on_world_machine_district_completed_country }
			}
			planet = {
				fire_on_action = { on_action = on_world_machine_district_completed_planet }
			}
			
		}
	}
	on_destroy = {
		if = {
			limit = { 
				owner = { has_origin = oxr_mdlc_origin_world_machine_awakened }
			}
			planet = {
				fire_on_action = { on_action = on_world_machine_district_demolished }
			}
		}
	}
}

xvcv_mdlc_pc_machine_auto_district_farming = {
	base_buildtime = @xvcv_mdlc_district_time_2
	icon = xvcv_mdlc_pc_mechanical_district_farming
	is_capped_by_modifier = no

	zone_slots = {
		oxr_mdlc_origin_wm_slot_food
	}

	show_on_uncolonized = {
		exists = from
		from = { oxr_mdlc_planet_owner_can_build_wm_districts = yes }
		uses_district_set = xvcv_mdlc_pc_machine_auto_district_set
	}
	potential = {
		exists = owner
		owner = { oxr_mdlc_planet_owner_can_build_wm_districts = yes }
		uses_district_set = xvcv_mdlc_pc_machine_auto_district_set
	}

	conversion_ratio = 1
	convert_to = {
		xvcv_mdlc_pc_machine_auto_district_farming_origin_wm
		district_farming_uncapped
		district_orchard_forests
		district_orchard_forests_uncapped
		district_nexus_3
		district_hive_3
	}

	resources = {
		category = xvcv_mdlc_world_machines_food_districts
		cost = {
			minerals = @xvcv_mdlc_district_cost_2
		}
		produces = {
			food = @[ 2 * oxr_mdlc_wm_base_farmer_output ]
			mult = value:scripted_modifier_mult|MODIFIER|rikk_mdlc_world_machine_districts_base_production|
		}
		produces = {
			trigger = {
				exists = owner
				owner = { has_tradition = tr_nanotech_1 }
			}
			nanites = @[ 2 * oxr_mdlc_wm_base_drone_nanite_output ]
			mult = value:scripted_modifier_mult|MODIFIER|rikk_mdlc_world_machine_districts_base_production|
		}
		upkeep = { 
			energy = @xvcv_mdlc_pc_machine_auto_district_farming_upkeep
		}
		produces = {
		trigger = { has_active_building = rikk_mdlc_world_machine_SR_building }
			exotic_gases = 0.20
			# mult = value:collected_world_machine_bonuses
			mult = value:scripted_modifier_mult|MODIFIER|rikk_mdlc_world_machine_districts_base_production|
		}
		upkeep = {
		trigger = { has_active_building = rikk_mdlc_world_machine_SR_building }
			energy = 1
		}
	}
	triggered_desc = {
		trigger = {
			has_active_building = rikk_mdlc_world_machine_SR_building
		}
		text = xvcv_mdlc_food_district_gas_produces
	}

	ai_resource_production = {
		food = 10
		trigger = { always = yes }
	}
	on_built = {
		if = {
			limit = { 
				owner = { has_origin = oxr_mdlc_origin_world_machine_awakened }
			}
			owner = {
				fire_on_action = { on_action = on_world_machine_district_completed_country }
			}
			fire_on_action = { on_action = on_world_machine_district_completed_planet }
		}
	}
	on_destroy = {
		fire_on_action = { on_action = on_world_machine_district_demolished }
	}
}
